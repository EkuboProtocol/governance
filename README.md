# Управление Ekubo

[![Tests](https://github.com/EkuboProtocol/governance/actions/workflows/test.yaml/badge.svg)](https://github.com/EkuboProtocol/governance/actions/workflows/test.yaml)

Простые контракты для токенизированного управления на Starknet.

## Принципы

Данные контракты следуют архитектуре управления проекта Compound.
Контракты не обнволяемы, так что проект разбит на модули и заменяемые компоненты.
Подразумевается, что все контракт обновляемы путем обычной миграции на новые версии.

Даже контракт токена может быть мигриован, если необходим, путем развертывания нового контракта, который позволяет сжечь старый токен и заминтить новый.

## Компоненты

- `Timelock` контракт с владельцем, который позволяет владельцу ставить на очередь список вызовов
    - Любой может совершать вызовы после промежутка времени, если владелец поставил их (вызовы) в очередь
    - Timelock обычно управляет всеми активами и редко обновляется
    - Чтобы обновить timelock, все активы должны быть перемещены на новый контракт timelock
- `Governor` контролирует голосование на вызове _single call_ , который можно добавить в timelock
    - Спроектирован так, чтобы быть владельцем Timelock
    - Одиночный вызов может быть постановкой в очередь вызовов `Timelock#queue(calls)`, которые, могут исполнять множество вызовов в одиночном предложении.
    - Владение Timelock может быть передано новому контракту управления в будущем, например, мигрировать на контракт голосования, основанный на volition.
    - Мета данные предложений не хранятся в governor, только лишь количество голосов
    - Предложения могут быть отменены в любой момент времени, если сила голоса предложившего упадет ниже минимального порогового значения
- `GovernanceToken` это токен стандарта ERC20, необходимый для голосвания в контрактах типа `Governor`
    - Пользователи должны делегировать свои токены для голосования и могут делегировать голоса сами себе
    - Позволяет другим контрактам получать среднюю силу голоса для *любого* исторического периода
    - Средневзвешенные голоса используются для вычисления силы голоса в контракте `Governor` в течение заданного периода времени
- `Airdrop` можно использовать для дистрибуцииGovernanceToken
    - Вычисление merkle root путем вычисления списка количеств и получателей, их хеширования и выстроения их в бинарное древо merkle
    - Развертывание аирдропа с данным корнем merkle и адресом токена
    - Перемещение общего количества токенов на контракт `Airdrop`
- `Factory` позволяет создавать полностью новый набор контрактов с помощью лишь одного вызова

## Testing

Make sure you have [Scarb with asdf](https://docs.swmansion.com/scarb/download#install-via-asdf) installed.

To run unit tests:

```
scarb test
```

## Disclaimer

These contracts are unaudited. Use at your own risk. Additional review is greatly appreciated.

## Credits

The [Airdrop](./src/airdrop.cairo) contract was heavily inspired by the [Carmine Options Airdrop contract](https://github.com/CarmineOptions/governance/blob/master/src/airdrop.cairo).
